// import {test, expect} from "@playwright/test"
// import { AboutSectionMenu } from '../../pages/aboutSection/AboutSectionMenu';
// import { ClientVulnerabilityPage } from '../../pages/aboutSection/ClientVulnerabilityPage';

// const licenses = [
//   {
//     name: "FCA",
//     baseUrl: "/en-gb",
//     expectedUrl: "/en-gb/help/client-vulnerability",
//   },
//   {
//     name: "SCA",
//     baseUrl: "/en-ae",
//     expectedUrl: "/en-ae/help/client-vulnerability",
//   },
//   {
//     name: "CySEC",
//     baseUrl: "/en-eu",
//     expectedUrl: "/en-eu/help/client-vulnerability",
//   },
//     name: "SCB",
//     baseUrl: "/en-int",
//     expectedUrl: "/en-int/help/client-vulnerability",
//   },
//   {
//     name: "ASIC",

//     baseUrl: "/en-au",
//     expectedUrl: "/en-au/help/client-vulnerability",
//   }
// ];


// licenses.forEach(({name, baseUrl, expectedUrl}) => {
//   test.describe.only(`Smoke_${name}_License(EN), Client vulnerability`, ()=> {
//     test.beforeEach(async ({page}) => {
//       await page.goto(`${baseUrl}`, {waitUntil: "domcontentloaded"})
//       const aboutSectionMenu = new AboutSectionMenu(page)
//       const clientVulnerabilityPage = new ClientVulnerabilityPage(page)
//       await aboutSectionMenu.openClientVulnerabilityPage()
//     })


//   test (`${name}_License(EN), "Create your account" button opens Sign up Form, UN`, 
//     async ({page}) => {
//       await expect(page).toHaveURL(`${expectedUrl}`)
//       await clientVulnerabilityPage.clickCreateYourAccountButtonFromReady()

//   })

// })
// })

// import { test } from "@playwright/test";
// import { AboutSectionMenu } from "../../pages/aboutSection/AboutSectionMenu";
// import { aboutMenuTexts } from "../../test-data/about-menu-texts";
// import { licenses } from "../../test-data/licenses";
// // import { aboutMenuTexts, licenses } from "../../test-data/about-menu-texts";

// licenses.forEach(({ name, urlPrefix }) => {
//   Object.keys(aboutMenuTexts.ABOUT).forEach((lang) => {
//     test(`${name} ${lang} – Client vulnerability`, async ({ page }) => {
//       await page.goto(`${urlPrefix}${lang.toLowerCase()}`); // URL diferă după limbă

//       const aboutMenu = new AboutSectionMenu(page);
//       await aboutMenu.openClientVulnerability(
//         aboutMenuTexts.ABOUT[lang],
//         aboutMenuTexts.CLIENT_VULNERABILITY[lang]
//       );
//     });
//   });
// });

import { test, expect } from "@playwright/test";
import { AboutSectionMenu } from "../../pages/aboutSection/AboutSectionMenu";
import { ClientVulnerabilityPage } from "../../pages/aboutSection/ClientVulnerabilityPage";
import { aboutMenuTexts } from "../../test-data/about-menu-texts";
import { licenses } from "../../test-data/licenses";
import { acceptAllCookies } from "../../helpers/pop_ups";

const languages = ["EN", "RO", "FR", "DE", "AR", "RU"];

licenses.forEach((license) => {
  languages.forEach((lang) => {
    if (!license.paths[lang]) return;

    test(`${license.name} ${lang} – Client vulnerability`, async ({ page }) => {
      const path = license.paths[lang];

      await page.goto(`https://capital.com${path}`, {
        waitUntil: "domcontentloaded",
      });

      const aboutMenu = new AboutSectionMenu(page);
      const clientVulnerabilityPage = new ClientVulnerabilityPage(page)

      // await acceptAllCookies(page)

      await aboutMenu.openClientVulnerability(
        aboutMenuTexts.ABOUT[lang],
        aboutMenuTexts.CLIENT_VULNERABILITY[lang]
      );      
      const expectedPath = `${path}/help/client-vulnerability`;

      await expect(page).toHaveURL(expectedPath);
      await clientVulnerabilityPage.clickCreateYourAccountButtonFromReady();
    });
  });
});






