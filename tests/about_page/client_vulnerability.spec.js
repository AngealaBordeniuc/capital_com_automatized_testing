
import { test, expect } from "@playwright/test";
import { AboutSectionMenu } from "../../pages/aboutSection/AboutSectionMenu";
import { ClientVulnerabilityPage } from "../../pages/aboutSection/ClientVulnerabilityPage";
import { aboutMenuTexts } from "../../test-data/about-menu-texts";
import { licenses } from "../../test-data/licenses";
import { acceptAllCookies } from "../../helpers/pop_ups";

const languages = ["EN", "RO", "FR", "DE", "AR", "RU"];

licenses.forEach((license) => {
  languages.forEach((lang) => {
    if (!license.paths[lang]) return;

    test(`${license.name} ${lang} â€“ Client vulnerability`, async ({ page }) => {
      const path = license.paths[lang];

      await page.goto(`https://capital.com${path}`, {
        waitUntil: "domcontentloaded",
      });

      const aboutMenu = new AboutSectionMenu(page);
      const clientVulnerabilityPage = new ClientVulnerabilityPage(page)

      // await acceptAllCookies(page)

      await aboutMenu.openClientVulnerability(
        aboutMenuTexts.ABOUT[lang],
        aboutMenuTexts.CLIENT_VULNERABILITY[lang]
      );      
      const expectedPath = `${path}/help/client-vulnerability`;

      await expect(page).toHaveURL(expectedPath);
      await clientVulnerabilityPage.clickCreateYourAccountButtonFromReady();
    });
  });
});






